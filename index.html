<!doctype html>

<!-- METADATA -->
<meta charset="utf-8">
<title>JS and Ruby in the browser (template)</title>

<!-- LOAD DEPENDENCIES -->
<script src="opal_app.js" type="text/javascript"></script>

<script src="bower_components/codemirror/lib/codemirror.js"></script>
<script src="bower_components/codemirror/mode/xml/xml.js"></script>
<link rel="stylesheet" type="text/css" href="bower_components/codemirror/lib/codemirror.css">
<link rel=stylesheet href="bower_components/codemirror/theme/base16-light.css">


<!-- TOSS SOME STYLES UP IN HERE! -->
<style>
body {
  margin:        3em;
  margin-bottom: 5em;
  font-size:     1.5em;
}
/* cm is the text editor, Code Mirror */
.cm {
  border:  2px solid blue;
  display: block;
  width:   50%;
}
</style>

<p>Edit your order</p>

<input type="text" id="orderNumber"></input>
<button id="getOrder">Get Order</button>

<textarea class="cm"></textarea>
<button id="shipOrder">Ship it!</button>

<script type="text/javascript">
var domOrderNumber = document.querySelector('#orderNumber')

var getOrder = document.querySelector('#getOrder')
console.log(getOrder)
getOrder.onclick = function() {
  var orderNumber = domOrderNumber.value;
  cm.setValue(
    "<order>" + orderNumber + "</order>" +
    "<user type=\"name\">Josh</user>"
  )
}

var dom = document.querySelector('.cm')
var cm  = CodeMirror.fromTextArea(dom, {
  mode:        "xml",
  lineNumbers: true,
  theme:       'base16-light',
})

var shipOrder = document.querySelector('#shipOrder')
shipOrder.onclick = function() {
  // here you would send it back to the server
  alert("Send this back to the server: " + cm.getValue())
}

window.cm = cm
</script>

